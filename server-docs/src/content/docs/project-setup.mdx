---
title: Project Setup
description: Configure Gradle and dependencies for Hytale plugins
---

**Goal:** Set up a Kotlin project for Hytale plugin development.

**Prerequisites:** [Introduction](/introduction), Gradle installed

## Plugin Template

Start with a pre-configured template for the fastest setup. The template includes:
- Gradle build configuration with shadow plugin
- Correct Java 25 / Kotlin 2.3.0 settings
- Example plugin structure
- Auto-deploy to server plugins folder

See [External Resources](/resources) for community template links.

## Step 1: Create Project Structure

```
my-plugin/
├── build.gradle.kts
├── settings.gradle.kts
├── gradle.properties
├── hytale_server/
│   └── HytaleServer.jar
└── src/
    └── main/
        ├── kotlin/
        │   └── com/example/myplugin/
        │       └── MyPlugin.kt
        └── resources/
            └── plugin.json
```

## Step 2: Configure Gradle

**settings.gradle.kts:**
```kotlin
rootProject.name = "my-plugin"
```

**gradle.properties:**
```properties
org.gradle.jvmargs=-Xmx2g
kotlin.jvm.target=25
```

**build.gradle.kts:**
```kotlin
plugins {
    kotlin("jvm") version "2.3.0"
    id("com.gradleup.shadow") version "9.0.0-beta12"
}

group = "com.example"
version = "1.0.0"

repositories {
    mavenCentral()
}

dependencies {
    // Hytale Server API (compile-only, provided at runtime)
    compileOnly(files("${project.projectDir}/hytale_server/HytaleServer.jar"))

    // Kotlin stdlib
    implementation(kotlin("stdlib"))
}

// Disable default jar, use shadow jar
tasks.jar {
    enabled = false
}

tasks.shadowJar {
    archiveFileName.set("my-plugin.jar")
    archiveClassifier.set("")

    mergeServiceFiles()

    // Copy to server plugins folder after build
    doLast {
        copy {
            from(archiveFile)
            into(file("hytale_server/plugins"))
        }
    }
}

tasks.build {
    dependsOn(tasks.shadowJar)
}
```

## Step 3: Create Plugin Manifest

Create `src/main/resources/plugin.json`:

```json
{
    "name": "MyPlugin",
    "group": "com.example",
    "version": "1.0.0",
    "main": "com.example.myplugin.MyPlugin",
    "description": "My Hytale plugin"
}
```

## Step 4: Get the Server JAR

Copy `HytaleServer.jar` from your Hytale server to `hytale_server/`:

```bash
mkdir -p hytale_server
cp /path/to/hytale/HytaleServer.jar hytale_server/
```

## Step 5: Build

```bash
./gradlew build
```

Output: `build/libs/my-plugin.jar` (also copied to `hytale_server/plugins/`)

## Development Workflow

1. Write code in `src/main/kotlin/`
2. Build: `./gradlew build`
3. Start server: `./hytale_server/start.sh`
4. Test in-game
5. Stop server, iterate

## Adding Dependencies

Add libraries to `dependencies` block:

```kotlin
dependencies {
    compileOnly(files("${project.projectDir}/hytale_server/HytaleServer.jar"))
    implementation(kotlin("stdlib"))

    // Example: JSON library
    implementation("com.google.code.gson:gson:2.10.1")

    // Example: Database
    implementation("org.jetbrains.exposed:exposed-core:0.45.0")
}
```

## Kotlin DSL Helpers

Add useful extensions for cleaner Kotlin code.

Create `src/main/kotlin/com/example/myplugin/utils/EventExtensions.kt`:

```kotlin
package com.example.myplugin.utils

import com.hypixel.hytale.event.EventRegistration
import com.hypixel.hytale.event.IBaseEvent
import com.hypixel.hytale.event.IEventRegistry
import java.util.function.Consumer

inline fun <reified EventType : IBaseEvent<Void>> IEventRegistry.register(
    noinline handler: (EventType) -> Unit
): EventRegistration<Void, EventType>? {
    return this.register(EventType::class.java, Consumer(handler))
}
```

Usage:
```kotlin
// Instead of
eventRegistry.register(PlayerConnectEvent::class.java) { event -> ... }

// Write
eventRegistry.register<PlayerConnectEvent> { event -> ... }
```

## Recommended Folder Structure

For larger plugins, organize your code:

```
my-plugin/
├── build.gradle.kts
├── settings.gradle.kts
├── gradle.properties
├── hytale_server/
│   ├── HytaleServer.jar
│   └── plugins/
└── src/main/
    ├── kotlin/com/example/myplugin/
    │   ├── MyPlugin.kt           # Main plugin class
    │   ├── commands/             # Command classes
    │   │   └── StatsCommand.kt
    │   ├── components/           # Custom components
    │   │   └── PlayerStatsComponent.kt
    │   ├── systems/              # ECS systems
    │   │   └── StatsTrackingSystem.kt
    │   ├── listeners/            # Event handlers
    │   │   └── PlayerListener.kt
    │   ├── services/             # Business logic
    │   │   └── StatsService.kt
    │   ├── storage/              # Data persistence
    │   │   └── StatsStorage.kt
    │   └── util/                 # Utilities
    │       └── Extensions.kt
    └── resources/
        └── plugin.json
```

## Server Authentication

The Hytale server requires authentication during development:

1. **Get Server Access** - Obtain server credentials from Hytale
2. **Configure Auth File** - Create `hytale_server/auth.json`:

```json
{
    "token": "your-developer-token"
}
```

3. **Environment Variable** (alternative):

```bash
export HYTALE_DEV_TOKEN="your-developer-token"
```

## Debug Mode Setup

Enable debug mode for development:

### Server Debug Flag

Start server with debug flag:

```bash
java -Dhytale.debug=true -jar HytaleServer.jar
```

### Remote Debugging

Attach a debugger from your IDE:

```bash
java -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=*:5005 \
     -jar HytaleServer.jar
```

Then in IntelliJ:
1. **Run > Edit Configurations**
2. Add **Remote JVM Debug**
3. Set host `localhost`, port `5005`
4. Click Debug to attach

### Gradle Debug Task

Add to `build.gradle.kts`:

```kotlin
tasks.register<Exec>("runServerDebug") {
    group = "hytale"
    description = "Run server with debugger"
    dependsOn("build")

    workingDir = file("hytale_server")
    commandLine = listOf(
        "java",
        "-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=*:5005",
        "-Dhytale.debug=true",
        "-Xmx4G",
        "-jar", "HytaleServer.jar"
    )
}
```

Run with: `./gradlew runServerDebug`

## Troubleshooting

**"Class file version 69" error:**
- Ensure Java 25 is installed and configured
- Set `kotlin.jvm.target=25` in gradle.properties

**Plugin not loading:**
- Check `plugin.json` is in JAR root
- Verify `main` class path matches your package

**Missing dependencies at runtime:**
- Use `implementation` for deps you need at runtime
- Use shadow plugin to bundle them in JAR

**Authentication failed:**
- Verify token is valid and not expired
- Check auth.json location and format

## Next Steps

- [Your First Plugin](/your-first-plugin) - Complete walkthrough
- [Handling Events](/handling-events) - React to game events
- [Creating Commands](/creating-commands) - Add commands
- [Gradle & Testing](/gradle-testing) - Advanced build setup
- [External Resources](/resources) - Community tools and templates
